<div class="w-full h-full bg-pattern flex flex-col items-center justify-center">
  <div @fadeInRight class="card overflow-hidden w-full max-w-md" style="background-color: white;">
    <div class="p-6 pb-0 flex flex-col mt-4">
      <div class="fill-current text-center" style="display: flex; align-items: center; justify-content: center;">
        <img style="width: 50%;" src="/assets/img/logo/DashCamPay_trasparente_large.png" />
      </div>
    </div>

    <div class="text-center" style="margin-top: 7%;">
      <h2 class="title m-0">¡Bienvenido!</h2>
      <h4 class="body-2 text-secondary m-0">
        Inicia sesión con tus credenciales a continuación.
      </h4>
    </div>

    <div class="p-2 flex flex-col gap-2">
      <form [formGroup]="signupForm" (ngSubmit)="agregar()" class="p-6 flex flex-col gap-4" novalidate>
        <div class="flex flex-col">
          <mat-form-field class="flex-1">
            <mat-label>Correo Electrónico</mat-label>
            <input matInput formControlName="userName" type="email" autocomplete="username" required />
            <mat-error *ngIf="signupForm.get('userName')?.hasError('required')">
              Ingresa tu correo para iniciar sesión.
            </mat-error>
          </mat-form-field>

          <mat-form-field class="flex-1 mt-3">
            <mat-label>Contraseña Nueva</mat-label>
            <input matInput [type]="typeNew" formControlName="password" autocomplete="new-password" required />
            <button type="button" mat-icon-button matIconSuffix (click)="togglePasswordNew()">
              <mat-icon>{{ typeNew === 'password' ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>

            <div *ngIf="showPwHint" class="pw-hint" [class.ok]="pwAllOk" [class.bad]="!pwAllOk"
                 [@fadeOnChange]="pwGuideKey" [@fadeInOut] aria-live="polite">
              <i class="fa" [ngClass]="pwAllOk ? 'fa-check-circle' : 'fa-exclamation-circle'"></i>
              {{ pwGuideText }}
            </div>
          </mat-form-field>

          <mat-form-field class="flex-1 mt-3">
            <mat-label>Confirmar Contraseña</mat-label>
            <!-- FIX: usar el control correcto -->
            <input matInput [type]="typeConfirm" formControlName="confirmPassword" autocomplete="new-password" required />
            <button type="button" mat-icon-button matIconSuffix (click)="togglePasswordConfirm()">
              <mat-icon>{{ typeConfirm === 'password' ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>

            <div *ngIf="showMatchHint" class="match-hint" [class.ok]="passwordsMatch" [class.bad]="!passwordsMatch"
                 [@fadeOnChange]="matchKey" [@fadeInOut] aria-live="polite">
              <i class="fa" [ngClass]="passwordsMatch ? 'fa-check-circle' : 'fa-exclamation-circle'"></i>
              {{ matchText }}
            </div>
          </mat-form-field>
        </div>

        <button class="mt-2 align" type="submit" [disabled]="signupForm.invalid || !pwAllOk || !passwordsMatch || loading">
          <span *ngIf="loading" class="loader"></span>
          <span style="margin-left: 3%;">{{ textLogin }}</span>
        </button>

        <div class="login-link-wrap">
          <a class="login-link" [routerLink]="['/forgot-password']">¿Olvidaste tu Contraseña?</a>
        </div>
      </form>
    </div>
  </div>
</div>
